% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HoMiCorr.R
\name{.prepare_data}
\alias{.prepare_data}
\title{Prepare Data for HoMiCorr (internal)}
\usage{
.prepare_data(
  mtx,
  host,
  covariates = NULL,
  metadata = NULL,
  sampleID = NULL,
  zibr_time_ind = NULL
)
}
\arguments{
\item{mtx}{A data frame containing microbiome data with row names as
sample identifiers and gene names as columns.}

\item{host}{A data frame containing host data with row names as
sample identifiers and gene names as columns.}

\item{covariates}{A character string specifying covariates to include
in the model formula (e.g., `"age + sex"`).
Random effects can also be passed (e.g., `"age + (1|participantID)"`).
If NULL, no covariates are used.}

\item{metadata}{A data frame containing metadata, including sample
identifiers and covariates.
Rows should correspond to samples, and covariates should be columns.
Can be NULL if no additional metadata is needed.}

\item{sampleID}{A character string specifying the column name in
`metadata` that contains sample identifiers.}

\item{zibr_time_ind}{A character string specifying a column in `metadata`
to be included in the merged data.}
}
\value{
A merged data frame containing microbiome data, host data,
and relevant metadata. The row names are set to sample identifiers.
}
\description{
This function merges microbiome data (`mtx`),
host data (`host`), and optional metadata (`metadata`)
while selecting relevant covariates and sample identifiers.
}
\examples{
# Simulate data with samples as rows and genes as columns
mtx <- data.frame(a1 = c(0.1, 0.0, 0.0, 0.0),
                  b1 = c(0.5, 0.5, 0.5, 0.4))
rownames(mtx) <- paste0("sample_", seq_len(4))

host <- data.frame(a2 = c(0.5, 0.0, 0.0, 0.0),
                   b2 = c(0.5, 0.5, 0.5, 0.4))
rownames(host) <- paste0("sample_", seq_len(4))

metadata <- data.frame(SampleID = paste0("sample_", seq_len(4)),
                       age = c(25, 30, 35, 40),
                       sex = c("M", "F", "M", "F"),
                       participantID = c(0, 1, 0, 1),
                       timepoint = c(0, 0, 1, 1))
rownames(metadata) <- metadata$SampleID

# Run .prepare_data function
result <- HoMiStats:::.prepare_data(mtx, host,
                                     "age + sex + (1|participantID)",
                                     metadata, "SampleID", "timepoint")
}
\keyword{internal}
